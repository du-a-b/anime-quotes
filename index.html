<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Legendary Anime Quotes ‚Äî Improved</title>
<style>
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%}
  body{
    font-family: Inter, Arial, Helvetica, sans-serif;
    background:#000;
    color:#fff;
    overflow:hidden;
  }

  .quote-container{
    position:relative;
    width:100%;
    height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    background-size:cover;
    background-position:center;
    transition:background-image 600ms ease, filter 400ms ease;
  }
  .overlay{
    position:absolute;inset:0;
    background:linear-gradient(180deg, rgba(0,0,0,0.55), rgba(0,0,0,0.45) 40%, rgba(0,0,0,0.7));
    pointer-events:none;
  }

  .quote-card{
    position:relative;
    z-index:2;
    max-width:900px;
    width:90%;
    padding:36px;
    background:rgba(3,3,3,0.45);
    border-radius:16px;
    border:1px solid rgba(255,255,255,0.08);
    backdrop-filter:blur(8px);
    box-shadow:0 10px 40px rgba(0,0,0,0.6);
    text-align:center;
    animation:cardIn .45s ease both;
  }
  @keyframes cardIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:none}}

  .quote-text{
    font-size:2.4rem;
    line-height:1.2;
    font-weight:300;
    margin-bottom:18px;
    text-shadow:0 6px 22px rgba(0,0,0,0.6);
  }
  .character{
    color:#ffd166;
    font-weight:700;
    font-size:1.25rem;
  }
  .anime{
    font-size:0.95rem;
    opacity:0.9;
    margin-top:6px;
    color:#ffffff;
  }

  .topbar{
    position:fixed;left:20px;top:18px;z-index:4;
    font-weight:800;font-size:1.2rem;
    background:linear-gradient(90deg,#ff7a7a,#ffd36b,#7bdff6,#ff9ff3);
    -webkit-background-clip:text;background-clip:text;color:transparent;
  }

  .counter{
    position:fixed;right:20px;top:18px;z-index:4;
    background:rgba(0,0,0,0.5);padding:8px 12px;border-radius:999px;
    border:1px solid rgba(255,255,255,0.06);font-weight:700;
  }

  .controls{
    position:fixed;left:50%;bottom:28px;transform:translateX(-50%);z-index:4;
    display:flex;gap:12px;
  }
  .btn{
    appearance:none;border:0;cursor:pointer;padding:12px 18px;border-radius:999px;
    background:rgba(255,255,255,0.08);color:#fff;font-weight:700;
    transition:all .18s ease;backdrop-filter:blur(6px);
  }
  .btn:hover{transform:translateY(-4px);background:rgba(255,255,255,0.12)}
  .btn:active{transform:translateY(-2px)}

  /* small screens */
  @media (max-width:720px){
    .quote-text{font-size:1.6rem}
    .quote-card{padding:18px;border-radius:12px}
    .controls{gap:8px;bottom:16px}
    .btn{padding:10px 14px;font-size:0.95rem}
  }
</style>
</head>
<body>
  <div class="topbar" aria-hidden="true">Legendary Quotes</div>
  <div class="counter" id="quoteCounter">1 / 10</div>

  <main class="quote-container" id="quoteContainer" role="main" aria-live="polite">
    <div class="overlay" aria-hidden="true"></div>

    <article class="quote-card" id="quoteCard">
      <div class="quote-text" id="quoteText">...</div>
      <div class="character" id="characterName">‚Äî Character</div>
      <div class="anime" id="animeName">Anime</div>
    </article>
  </main>

  <nav class="controls" aria-label="Quote controls">
    <button class="btn" id="prevBtn" aria-label="Previous quote">‚Üê Previous</button>
    <button class="btn" id="nextBtn" aria-label="Next quote">Next ‚Üí</button>
    <button class="btn" id="randBtn" aria-label="Random quote">üé≤ Random</button>
    <button class="btn" id="readBtn" aria-label="Read aloud">üîä Read</button>
    <button class="btn" id="stopBtn" aria-label="Stop reading">‚èπ Stop</button>
  </nav>

<script>
/* -------------------------
   Quotes (balanced genders)
   All backgrounds are high-res wallpaper links.
   If any fail to load we fallback gracefully.
   ------------------------- */
const fallbackGradient = 'linear-gradient(180deg,#0f1720,#02040a)';

const quotes = [
  { text: "The only way to truly escape the ordinary is never to give up on your dreams, no matter how impossible they seem.", character: "Monkey D. Luffy", anime: "One Piece", gender: "male", background: "https://images.4kwallpapers.com/uploads/wallpaper/54002/gear-5-luffy-one-piece.jpg" },
  { text: "True strength isn't about having power over others, but having power over yourself.", character: "Naruto Uzumaki", anime: "Naruto", gender: "male", background: "https://images7.alphacoders.com/131/1314622.jpg" },
  { text: "A lesson in chasing your dreams is also a lesson in finding yourself.", character: "Hinata Hyuga", anime: "Naruto", gender: "female", background: "https://images5.alphacoders.com/131/1312976.jpg" },
  { text: "We are all like fireworks - we climb, shine, and always go our separate ways and become further apart.", character: "Okabe Rintarou", anime: "Steins;Gate", gender: "male", background: "https://images7.alphacoders.com/787/787016.jpg" },
  { text: "I will never stop believing in my friends. That's my nind≈ç!", character: "Sakura Haruno", anime: "Naruto", gender: "female", background: "https://images3.alphacoders.com/131/1315473.jpg" },
  { text: "People's lives don't end when they die. It ends when they lose faith.", character: "Itachi Uchiha", anime: "Naruto", gender: "male", background: "https://images5.alphacoders.com/606/606284.jpg" },
  { text: "The world isn't perfect, but it's there for us doing the best it can. That's what makes it so beautiful.", character: "Roy Mustang", anime: "Fullmetal Alchemist", gender: "male", background: "https://images6.alphacoders.com/122/1224243.jpg" },
  { text: "Sometimes it's not about doing what's easy, it's about doing what's right.", character: "Mikasa Ackerman", anime: "Attack on Titan", gender: "female", background: "https://images8.alphacoders.com/131/1315843.jpg" },
  { text: "If you don't take risks, you can't create a future.", character: "Monkey D. Luffy", anime: "One Piece", gender: "male", background: "https://images.4kwallpapers.com/uploads/wallpaper/54002/gear-5-luffy-one-piece.jpg" },
  { text: "Being alone is not the same as being lonely. Sometimes you need solitude to find yourself.", character: "L Lawliet", anime: "Death Note", gender: "male", background: "https://images8.alphacoders.com/126/1268023.jpg" }
];

/* Preload images and mark failures */
function preloadBackgrounds(list) {
  list.forEach(q => {
    const img = new Image();
    img.onload = () => q._ok = true;
    img.onerror = () => {
      q._ok = false;
      // optional: replace with a hosted fallback image or keep gradient
      q._fallback = fallbackGradient;
    };
    img.src = q.background;
  });
}

/* -------------------------
   Speech Synthesis: preferring Japanese voices
   ------------------------- */

let voiceList = [];
let voicesLoaded = false;

function loadVoices() {
  voiceList = window.speechSynthesis.getVoices() || [];
  voicesLoaded = true;
}
window.speechSynthesis.onvoiceschanged = loadVoices;
loadVoices();

/* Heuristics to pick voices:
   - Prefer voices with lang starting with 'ja'
   - Then try to pick male/female variants by name heuristics
   - Fallback to en voices with gender preference
*/
function pickVoice(gender) {
  const prefersJa = v => v.lang && v.lang.toLowerCase().startsWith('ja');
  const prefersEn = v => v.lang && v.lang.toLowerCase().startsWith('en');

  const maleNameHints = ['hiro', 'hiroshi', 'takumi', 'ken', 'yuki', 'taichi', 'takashi', 'shinji', 'vocal'];
  const femaleNameHints = ['kyoko', 'haruka', 'yumi', 'saki', 'maaya', 'ayumi', 'yui', 'nanami'];

  // helper to match hint
  const matchHint = (name, hints) => {
    if(!name) return false;
    const n = name.toLowerCase();
    return hints.some(h=> n.includes(h));
  };

  // 1) Japanese voices ‚Äî exact gender hint
  let jaVoices = voiceList.filter(prefersJa);
  if (jaVoices.length) {
    // try hint match
    let match;
    if (gender === 'female') match = jaVoices.find(v=>matchHint(v.name,femaleNameHints));
    else match = jaVoices.find(v=>matchHint(v.name,maleNameHints));
    if (match) return match;
    // else return any Japanese voice (female prefer slightly higher pitch later)
    return jaVoices[0];
  }

  // 2) Fallback to English voices with hint matching
  let enVoices = voiceList.filter(prefersEn);
  if (enVoices.length) {
    let match;
    if (gender === 'female') match = enVoices.find(v=>matchHint(v.name,femaleNameHints) || /female|woman|samantha|karen|alloy/i.test(v.name));
    else match = enVoices.find(v=>matchHint(v.name,maleNameHints) || /male|man|david|michael|alex/i.test(v.name));
    return match || enVoices[0];
  }

  // 3) final fallback: first available
  return voiceList[0] || null;
}

/* Read a quote (gender-aware) */
let speaking = false;
function readCurrentQuote() {
  if(!voicesLoaded) loadVoices();
  const q = quotes[currentIndex];
  if(!q) return;

  // cancel ongoing
  window.speechSynthesis.cancel();

  // choose voice
  const voice = pickVoice(q.gender);
  const textToSpeak = (voice && voice.lang && voice.lang.toLowerCase().startsWith('ja'))
    ? ( // if using Japanese voice, use a short Japanese-friendly line structure
        `${q.character} „ÅÆË®ÄËëâ„Åß„Åô„ÄÇ ${q.text}`
      )
    : `${q.text} ‚Äî ${q.character} from ${q.anime}.`;

  const u = new SpeechSynthesisUtterance(textToSpeak);
  if (voice) u.voice = voice;

  // tune pitch/rate for anime-like effect
  if (q.gender === 'female') {
    u.pitch = 1.35;
    u.rate = (voice && voice.lang && voice.lang.startsWith('ja')) ? 1.02 : 1.05;
  } else {
    u.pitch = 0.95;
    u.rate = (voice && voice.lang && voice.lang.startsWith('ja')) ? 0.95 : 1.0;
  }

  // ensure lang matches voice for better pronunciation
  if (voice && voice.lang) u.lang = voice.lang;
  else u.lang = 'en-US';

  u.onstart = () => { speaking = true; updateReadButton(); };
  u.onend = u.onerror = () => { speaking = false; updateReadButton(); };

  // speak
  window.speechSynthesis.speak(u);
}

/* Stop reading */
function stopReading() {
  window.speechSynthesis.cancel();
  speaking = false;
  updateReadButton();
}

function updateReadButton(){
  const b = document.getElementById('readBtn');
  if(speaking) b.textContent = 'üîä Reading‚Ä¶';
  else b.textContent = 'üîä Read';
}

/* -------------------------
   UI: navigation and rendering
   ------------------------- */
let currentIndex = 0;

function setBackgroundForQuote(q){
  // If preloaded ok, use it; otherwise try assigned URL and fallback to gradient
  const container = document.getElementById('quoteContainer');
  if (q._ok !== false && q.background) {
    // set with CSS url
    container.style.backgroundImage = `url('${q.background}')`;
    container.style.filter = 'none';
  } else {
    container.style.backgroundImage = q._fallback || fallbackGradient;
    container.style.filter = 'saturate(.9) contrast(.95)';
  }
}

function renderQuote(index){
  const q = quotes[index];
  document.getElementById('quoteText').textContent = q.text;
  document.getElementById('characterName').textContent = '‚Äî ' + q.character;
  document.getElementById('animeName').textContent = q.anime;
  document.getElementById('quoteCounter').textContent = `${index + 1} / ${quotes.length}`;
  setBackgroundForQuote(q);
}

function nextQuote(){
  currentIndex = (currentIndex + 1) % quotes.length;
  renderQuote(currentIndex);
  stopReading();
}
function prevQuote(){
  currentIndex = (currentIndex - 1 + quotes.length) % quotes.length;
  renderQuote(currentIndex);
  stopReading();
}
function randomQuote(){
  let i;
  do { i = Math.floor(Math.random()*quotes.length); } while(i===currentIndex && quotes.length>1);
  currentIndex = i;
  renderQuote(currentIndex);
  stopReading();
}

/* keyboard shortcuts:
   ArrowRight / Space -> next
   ArrowLeft -> previous
   r -> random
   s -> toggle read/stop
*/
document.addEventListener('keydown', (e)=>{
  if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); nextQuote(); }
  else if (e.key === 'ArrowLeft') { prevQuote(); }
  else if (e.key.toLowerCase() === 'r') { randomQuote(); }
  else if (e.key.toLowerCase() === 's') {
    if (speaking) stopReading(); else readCurrentQuote();
  }
});

/* hook controls */
document.getElementById('nextBtn').addEventListener('click', nextQuote);
document.getElementById('prevBtn').addEventListener('click', prevQuote);
document.getElementById('randBtn').addEventListener('click', randomQuote);
document.getElementById('readBtn').addEventListener('click', ()=>{ if(speaking) stopReading(); else readCurrentQuote();});
document.getElementById('stopBtn').addEventListener('click', stopReading);

/* Init */
preloadBackgrounds(quotes);
renderQuote(0);
updateReadButton();

</script>
</body>
</html>
